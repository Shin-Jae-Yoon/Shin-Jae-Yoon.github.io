<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="단편적 지식을 통합된 지식으로"><meta property="og:type" content="website"><meta property="og:url" content="https://shin-jae-yoon.github.io/"><meta property="og:site_name" content="개발자 유니의 두 번째 뇌"><meta property="og:title" content="개발자 유니의 두 번째 뇌"><meta property="og:description" content="단편적 지식을 통합된 지식으로"><meta property="og:image" content="https://img1.daumcdn.net/thumb/C428x428/?scode=mtistory2&fname=https%3A%2F%2Ftistory4.daumcdn.net%2Ftistory%2F5252507%2Fattach%2F9c3ad58fd9d24ab486b8a4258ba525d2"><meta property="og:article:author" content="유니"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@TISTORY"><meta property="twitter:title" content="개발자 유니의 두 번째 뇌"><meta property="twitter:description" content="단편적 지식을 통합된 지식으로"><meta property="twitter:image" content="https://img1.daumcdn.net/thumb/C428x428/?scode=mtistory2&fname=https%3A%2F%2Ftistory4.daumcdn.net%2Ftistory%2F5252507%2Fattach%2F9c3ad58fd9d24ab486b8a4258ba525d2"><meta name=naver-site-verification content="9e162597b5777707f80d8478ef502c5224430d43"><script async src="https://www.googletagmanager.com/gtag/js?id=G-GJFBQJ80N7"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-GJFBQJ80N7")</script><title>개발자 유니의 두 번째 뇌</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://shin-jae-yoon.github.io//icon.png><link href=https://shin-jae-yoon.github.io/styles.e09802ffac0c4a4ea979236836845116.min.css rel=stylesheet><link href=https://shin-jae-yoon.github.io/styles/_light_syntax.b3cdc1af6c90d5fc7e05ca6e6e6f3e60.min.css rel=stylesheet id=theme-link><script src=https://shin-jae-yoon.github.io/js/darkmode.bc2675e781c280aaf6b5cc1b2bc0d940.min.js></script>
<script src=https://shin-jae-yoon.github.io/js/util.9f16e8e6e851e38941fee1829bbdba7e.min.js></script>
<script src=https://shin-jae-yoon.github.io/js/scroll.dd2afb7d6055a9d76e9662a2abb5fb6b.min.js></script>
<link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css as=style onload='this.onload=null,this.rel="stylesheet"' integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script async src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script async src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script async src=https://shin-jae-yoon.github.io/js/popover.b71dd27f329bec6e58788f7b5d4fc3f7.min.js></script>
<script defer src=https://shin-jae-yoon.github.io/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://shin-jae-yoon.github.io/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://shin-jae-yoon.github.io/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!0,PRODUCTION=!0,BASE_URL="https://shin-jae-yoon.github.io/",fetchData=Promise.all([fetch("https://shin-jae-yoon.github.io/indices/linkIndex.f07f75625d8d4af8675f5e8ee482c8b6.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://shin-jae-yoon.github.io/indices/contentIndex.3a69806cb5fb68301ca0fab359f40a94.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://shin-jae-yoon.github.io",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!0;drawGraph("https://shin-jae-yoon.github.io",t,[{"/moc":"#4388cc"}],t?{centerForce:5,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.3}:{centerForce:5,depth:2,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:2.5,repelForce:1,scale:1.3})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'’':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/shin-jae-yoon.github.io\/js\/router.162c60c52b64db415c2b2aa296e7caeb.min.js"
    attachSPARouting(init, render)
  </script><script src=https://kit.fontawesome.com/1f943b0307.js crossorigin=anonymous></script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder=" 검색어를 입력하세요 "><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://shin-jae-yoon.github.io/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><div class=singlePage><header style=margin-bottom:0><img src="https://img1.daumcdn.net/thumb/C32x32/?scode=mtistory2&fname=https%3A%2F%2Ftistory3.daumcdn.net%2Ftistory%2F5252507%2F9f1447b3d8ac45ffa6c01c21fa6aec75"><h1 style=margin-left:.2em id=page-title><a href=https://shin-jae-yoon.github.io/>개발자 유니 - 두 번째 뇌</a></h1><h1 style=margin-left:.2em id=page-title2><a href=https://shin-jae-yoon.github.io/>개발자 유니</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div style=margin-left:1em><a href=/tags><i class="fa-solid fa-hashtag"></i></a></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><div style=margin-bottom:3em><ul class=header-nav><li style=margin-right:1em><a href=https://shin-jae-yoon.github.io/>Home</a></li><li style=margin-right:1em><a href=/about/>About</a></li><li style=margin-right:1em><a href=https://shin-jae-yoon.github.io/notes/TIL/TIL>TIL</a></li><li><a href=/notes/Interview/Interview>Interview</a></li></ul></div><article><h1>Exception Handling</h1><p class=meta>Last updated -
2023년 02월 22일
<a href=https://github.com/Shin-Jae-Yoon/Shin-Jae-Yoon.github.io/tree/hugo/content/notes/Interview/dog-study/dog-week02.md rel=noopener>Edit Source</a></p><ul class=tags><li><a href=https://shin-jae-yoon.github.io/tags/Exception-Handling/>Exception Handling</a></li><li><a href=https://shin-jae-yoon.github.io/tags/Spring-%EC%98%88%EC%99%B8-%EC%B2%98%EB%A6%AC/>Spring 예외 처리</a></li><li><a href=https://shin-jae-yoon.github.io/tags/Spring-%EC%98%88%EC%99%B8-%ED%9D%90%EB%A6%84/>Spring 예외 흐름</a></li></ul><aside class=mainTOC><details><summary>CONTENTS</summary><nav id=TableOfContents><ul><li><a href=#topic-01---예외-핸들링>TOPIC 01 - 예외 핸들링</a><ul><li><a href=#예외복구>예외복구</a></li><li><a href=#예외회피>예외회피</a></li><li><a href=#예외전환>예외전환</a></li><li><a href=#다중-catch>다중 catch</a></li><li><a href=#멀티-catch>멀티 catch</a></li><li><a href=#에러-출력-메서드>에러 출력 메서드</a></li><li><a href=#진짜-handling>진짜 Handling</a></li><li><a href=#printstacktrace-취약점>printStackTrace 취약점</a></li><li><a href=#try-with-resources>try-with-resources</a></li><li><a href=#try-catch-성능>try-catch 성능</a></li></ul></li><li><a href=#topic-02---spring에서는>TOPIC 02 - Spring에서는?</a><ul><li><a href=#스프링-예외처리>스프링 예외처리</a></li><li><a href=#dispatcher-servlet-내에서>Dispatcher Servlet 내에서</a></li><li><a href=#handlerexceptionresolver>HandlerExceptionResolver</a></li><li><a href=#dispatcher-servlet-외부에서>Dispatcher Servlet 외부에서</a></li><li><a href=#filter에서-처리하는-예외>Filter에서 처리하는 예외</a></li><li><a href=#참고자료>참고자료</a></li></ul></li></ul></nav></details></aside><div class=asideTOCbox><aside class=asideTOC id=asideTOC><div id=asideTocTitleBox><a href=# id=asideTocTitle>CONTENTS</a></div><nav id=TableOfContents><ul><li><a href=#topic-01---예외-핸들링>TOPIC 01 - 예외 핸들링</a><ul><li><a href=#예외복구>예외복구</a></li><li><a href=#예외회피>예외회피</a></li><li><a href=#예외전환>예외전환</a></li><li><a href=#다중-catch>다중 catch</a></li><li><a href=#멀티-catch>멀티 catch</a></li><li><a href=#에러-출력-메서드>에러 출력 메서드</a></li><li><a href=#진짜-handling>진짜 Handling</a></li><li><a href=#printstacktrace-취약점>printStackTrace 취약점</a></li><li><a href=#try-with-resources>try-with-resources</a></li><li><a href=#try-catch-성능>try-catch 성능</a></li></ul></li><li><a href=#topic-02---spring에서는>TOPIC 02 - Spring에서는?</a><ul><li><a href=#스프링-예외처리>스프링 예외처리</a></li><li><a href=#dispatcher-servlet-내에서>Dispatcher Servlet 내에서</a></li><li><a href=#handlerexceptionresolver>HandlerExceptionResolver</a></li><li><a href=#dispatcher-servlet-외부에서>Dispatcher Servlet 외부에서</a></li><li><a href=#filter에서-처리하는-예외>Filter에서 처리하는 예외</a></li><li><a href=#참고자료>참고자료</a></li></ul></li></ul></nav></aside></div><div class=tpstyle-yes><p><a href=https://github.com/dingding-21/Rebellion-Of-Interviewees/issues/4 target=_blank>2주차 스터디 Issue 바로가기</a></p><hr><blockquote class=note-callout><p>2주차 스터디</p><p><strong>TOPIC - 01</strong><br>   Java의 Exception Handling 방법에 대하여 설명해주세요.<br><br><strong>TOPIC - 02</strong><br>   Spring에서의 예외 처리 방법과 흐름에 관하여 설명해주세요.</p></blockquote><a href=#topic-01---예외-핸들링><h2 id=topic-01---예외-핸들링><span class=hanchor arialabel=Anchor># </span>TOPIC 01 - 예외 핸들링</h2></a><p>제공하고 있는 서비스가 <strong>프로그램 실행 중</strong> 어떤 원인에 의하여 비정상적으로 종료가 되었다고 하자. 이러한 경우 대처를 어떻게 해야할까?</p><ul><li><strong>실행 중을 뜻하는 것이라서 Runtime Exception을 의미</strong>하는 것이다.<ul><li>Error : 오류는 메모리 부족, 스택오버플로우와 같이 일단 발생하면 복구할 수 없는 심각한 오류이기 때문에 개발자가 예측이 불가능하다. 따라서 프로그램 코드에 어떠한 대비는 불가능</li><li>Exception : Exception Handling을 통하여 개발자가 예측해서 프로그램 코드에 대비가 가능하다.<ul><li>Checked Exception : Runtime 시점이기 때문에 고려하지 않는다. 애초에 Checked Exception이면 컴파일 자체가 안되고 빨간줄이 뜰 것</li><li><strong>Unchecked Exception : 바로 이 부분에 관하여 핸들링하는 것이다.</strong></li></ul></li></ul></li></ul><br><a href=#예외복구><h3 id=예외복구><span class=hanchor arialabel=Anchor># </span>예외복구</h3></a><ul><li>Exception이 발생하여도 Application은 정상적으로 동작</li><li>Exception 발생 시 이를 예측하여 다른 비즈니스 로직 흐름으로 유도</li><li>Exception이 발생하지 않는 상황으로 복구를 시도하는 로직을 추가</li><li><code>try-catch-finally</code> 블록을 이용하여 예외상황을 파악하고 정상상태로 되돌려 놓는 것</li></ul><p>예를 들어, 네트워크의 환경이 좋지 않아서 서버에 접속이 안되는 상황의 시스템에 적용하면 효율적일 것이다.</p><details><summary><strong><mark>코드 예시보기</mark></strong></summary><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>private</span> <span class=kt>void</span> <span class=nf>NetworkThrowException</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>maxTry</span> <span class=o>=</span> <span class=n>5</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=o>(</span><span class=n>maxTry</span> <span class=o>--&gt;</span> <span class=n>0</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    	<span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    		<span class=c1>// RandomException 이 Throw 될 수 가능성이 있는 로직
</span></span></span><span class=line><span class=cl><span class=c1></span>        	<span class=c1>// 성공 시 return, 해당 메소드 종료
</span></span></span><span class=line><span class=cl><span class=c1></span>        	<span class=k>return</span> <span class=o>;</span>
</span></span><span class=line><span class=cl>    	<span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>RandomException</span> <span class=n>re</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    		<span class=c1>// Error 로그 출력
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>// 실패 로직 존재 시 원상 복구
</span></span></span><span class=line><span class=cl><span class=c1></span>        	<span class=c1>// 일정 시간 동안 대기
</span></span></span><span class=line><span class=cl><span class=c1></span>    	<span class=o>}</span> <span class=k>finally</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    		<span class=c1>// 작업에 사용한 Resource 반환 및 정리
</span></span></span><span class=line><span class=cl><span class=c1></span>    	<span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 최대 횟수 실패시 예외 Throw
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>throw</span> <span class=k>new</span> <span class=n>MaxTryFailedException</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// 혹은 네트워크 연결 실패 페이지로 이동시켜 흐름을 전환할 수도 있음
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div></details><br><a href=#예외회피><h3 id=예외회피><span class=hanchor arialabel=Anchor># </span>예외회피</h3></a><ul><li>메서드에 <code>throws</code>를 붙여서 예외처리를 직접 담당하지 않고 호출한 쪽으로 던져서 회피</li><li>예외를 회피하고 던지는 것이 정말 최선일 경우에만 던지기</li><li>긴밀하게 역할을 분담하고 있는 경우가 아니라면, 굉장히 무책임한 행동</li><li>프로그래머가 예외처리를 각자 프로그램에 맞기 처리하도록 유도하는 경우에는 괜찮을 수도 있음</li></ul><blockquote class=note-callout><p>잠깐! throw와 throws의 차이는?</p><p></p><ul><li><strong>throw</strong>는 예외를 던져주는 코드, 특정 조건에서 예외를 던지는 것, 사용자가 직접 예외를 만들어서 일부로 발생시킬 때 사용하는 것</li><li><strong>throws</strong>는 throw 값을 받는 곳에서 예외를 처리하도록 하여, 예외처리의 주체를 바꿔주는 것</li><li>메서드 옆에 붙이는 건 <strong>throws</strong>, new 연산자 옆에 붙이는게 <strong>throw</strong></li></ul></blockquote><br><a href=#예외전환><h3 id=예외전환><span class=hanchor arialabel=Anchor># </span>예외전환</h3></a><ul><li>특정 Exception 발생 시 명확한 의미의 새로운 Exception으로 전환하고 호출한 쪽으로 던짐</li><li>호출 부분에서 Exception Handling 할 때, 어떤 Exception인지 분명하게 하여 해당하는 Exception에 대한 Handling이 수월하게 해주는 것</li><li><code>Checked Exception</code>처럼 복구 불가능한 Exception을 <strong>catch</strong>하여 <code>Unchecked Exception</code>으로 전환하여 Handling 하면 다른 계층에서 일일이 Checked Exception을 선언하지 않도록 한다</li></ul><p>예를 들어, 클라이언트 단에서는 SQLException에 대하여 어떻게 처리해야할 지 모를 것이다. 이러한 Checked Exception에 관하여 <strong>서버 단에서 클라이언트 단에게 에러 메세지를 정확하게 알려주고 싶은 경우</strong>에 사용하면 유용한 방법이다.</p><p>대표적인 예시로, Spring에서 로그인 5회이상 실패 혹은 잘못된 이미지 파일 확장자 검사 등 예외상황에 Unchecked Exception으로 처리하는 것이 일반적이다.</p><details><summary><strong><mark>코드 예시보기</mark></strong></summary><p><a href=https://dev-cool.tistory.com/24 target=_blank>코드출처</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ExceptionTest</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>CustomException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>		<span class=n>String</span> <span class=n>test</span> <span class=o>=</span> <span class=s>&#34;test&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>			<span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>test</span><span class=o>.</span><span class=na>getBytes</span><span class=o>());</span>
</span></span><span class=line><span class=cl>		<span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>IOException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>			<span class=k>throw</span> <span class=k>new</span> <span class=n>CustomException</span><span class=o>(</span><span class=s>&#34;list 못 읽음&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>		<span class=o>}</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>UncheckedExceptionTest</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>static</span> <span class=n>String</span> <span class=n>test</span><span class=o>;</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>NullPointerException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>		<span class=n>String</span> <span class=n>test2</span> <span class=o>=</span> <span class=n>test</span><span class=o>.</span><span class=na>toLowerCase</span><span class=o>();</span>
</span></span><span class=line><span class=cl>		<span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>test2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div></details><p><br><br></p><a href=#다중-catch><h3 id=다중-catch><span class=hanchor arialabel=Anchor># </span>다중 catch</h3></a><p>try 블록 내부는 다양한 종류의 예외가 발생할 수 있다. 이를 해결하는 방법이 여러 개의 catch문을 사용하는 것이다.</p><p><strong>하지만 catch 블록이 여러 개라 할지라도 단 하나의 catch 블록만 실행된다.</strong> 그 이유는 try 블록에서 동시 다발적으로 예외가 발생하지 않고, 하나의 예외가 발생하면 즉시 실행을 멈추고 해당 catch
블록으로 이동하기 때문이다.</p><p><strong>그렇기 때문에 상위 예외 클래스가 하위 예외 클래스(더 상세한)보다 아래쪽에 위치해야 한다.</strong> try블록에서 예외가 발생했을 때, 예외를 처리해줄 catch블록은 위에서부터 차례대로 검색된다. 만약, 상위 예외 클래스의 catch블록이 위에 있다면, 하위 예외 클래스의 catch 블록은 실행되지 않는다.</p><p>왜냐하면 <mark>하위 예외는 상위 예외를 상속했기 때문에 상위 예외 타입도 되기 때문</mark>이다. 아래 코드 예시처럼 상위 예외 클래스인 Exception이 ArrayIndexOutOfBoundsException보다 위에 있으면 에러가 난다.</p><details><summary><strong><mark>코드 예시보기</mark></strong></summary><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Exception이 더 상위니까 에러남
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>CatchExceptionTest</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>		    <span class=c1>// 블라블라~ 
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>Exception</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>ArrayIndexOutOfBoundsException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>  
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 상위 예외 클래스가 아래로 가야 에러가 안남
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>CatchExceptionTest</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>		    <span class=c1>// 블라블라~ 
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>ArrayIndexOutOfBoundsException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>Exception</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>  
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div></details><p><br><br></p><a href=#멀티-catch><h3 id=멀티-catch><span class=hanchor arialabel=Anchor># </span>멀티 catch</h3></a><p><a href=https://dololak.tistory.com/61 target=_blank>[관련 출처]</a> 하나의 catch 블록에서 여러 개의 예외를 처리하는 것이다. <code>|</code>로 예외 연결한다. 그러나, 다중 catch처럼 멀티 catch도 사용 시 주의사항이 있다.</p><ol><li><strong>Multi Catch문에 사용된 예외들은 예외의 상속관계에서 부모와 자식관계에 있으면 안된다.</strong></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl><span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>ArithmeticException</span> <span class=o>|</span> <span class=n>RuntimeException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Exception in thread &#34;main&#34; java.lang.Error: Unresolved compilation problem: 
</span></span></span><span class=line><span class=cl><span class=c1>// The exception ArithmeticException is already caught by the alternative RuntimeException
</span></span></span></code></pre></td></tr></table></div></div><p><code>ArithmeticException</code>은 <code>RuntimeException</code>의 자손 클래스이기 때문에 <mark>RuntimeException 하나만으로 처리가 가능하기 때문</mark>에 예외가 발생한다. 즉, <strong>다형성에 의해 RuntimeException 하나로 자손 예외들을 모두 처리 가능</strong>하다는 의미이다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 이렇게 수정하면 정상작동
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl><span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>RuntimeException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>RuntimeException</span> <span class=n>하나로</span> <span class=n>하위</span> <span class=n>예외들을</span> <span class=n>모두</span> <span class=n>처리</span>           
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><br><ol start=2><li><strong>Multi Catch문에 사용된 예외들의 공통된 조상의 멤버만 사용할 수 있다.</strong></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=k>catch</span> <span class=o>(</span><span class=n>ExceptionA</span> <span class=o>|</span> <span class=n>ExceptionB</span> <span class=o>|</span> <span class=n>ExceptionC</span> <span class=n>e</span><span class=err></span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=n>e</span><span class=o>.</span><span class=na>methodA</span><span class=o>();</span>
</span></span><span class=line><span class=cl>	<span class=c1>// e라는 참조변수 하나로 여러 가지 예외를 처리하기 때문에
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=c1>// e가 A, B, C 어느 예외인지 몰라서 처리할 수 없다.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Multi Catch문에서는 <mark>공통된 조상의 메서드만 호출하거나 정확히 어느 예외의 인스턴스인지 판단하여 캐스팅(형변환) 후 해당 메서드를 사용</mark>해야 한다.</p><p align=center><img src=https://i.imgur.com/aqNQUD5.png width=80%></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl><span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>ChildExA</span> <span class=o>|</span> <span class=n>ChildExB</span> <span class=o>|</span> <span class=n>ChildExC</span> <span class=n>e</span><span class=o>){</span>
</span></span><span class=line><span class=cl>   <span class=n>e</span><span class=o>.</span><span class=na>parentsMethod</span><span class=o>();</span> <span class=c1>//공통조상인 parentsMethod()만 호출 가능
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><br><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl><span class=o>}</span> <span class=k>catch</span><span class=o>(</span><span class=n>ChildExA</span> <span class=o>|</span> <span class=n>ChildExB</span> <span class=o>|</span> <span class=n>ChildExC</span> <span class=n>e</span><span class=o>){</span>
</span></span><span class=line><span class=cl>   <span class=k>if</span> <span class=o>(</span><span class=n>e</span> <span class=k>instanceof</span> <span class=n>ChildExA</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>       <span class=n>ChildExA</span> <span class=n>a</span> <span class=o>=</span> <span class=o>(</span><span class=n>ChildExA</span><span class=o>)</span><span class=n>e</span><span class=o>;</span> <span class=c1>//캐스팅
</span></span></span><span class=line><span class=cl><span class=c1></span>       <span class=n>a</span><span class=o>.</span><span class=na>childMethodA</span><span class=o>();</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span> <span class=k>else</span> <span class=k>if</span> <span class=o>(</span><span class=n>e</span> <span class=k>instanceof</span> <span class=n>ChildExB</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>       <span class=n>ChildExB</span> <span class=n>b</span> <span class=o>=</span> <span class=o>(</span><span class=n>ChildExB</span><span class=o>)</span><span class=n>e</span><span class=o>;</span> <span class=c1>//캐스팅                     
</span></span></span><span class=line><span class=cl><span class=c1></span>       <span class=n>b</span><span class=o>.</span><span class=na>childMethodB</span><span class=o>();</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span> <span class=k>else</span><span class=o>{</span> <span class=o>...</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>그런데, 코드를 보면 이렇게 캐스팅해서 if문 쓸바에 평소대로 여러 개의 캐치문을 쓰는게 낫다</p><br><a href=#에러-출력-메서드><h3 id=에러-출력-메서드><span class=hanchor arialabel=Anchor># </span>에러 출력 메서드</h3></a><ul><li><code>e.getMessage()</code> : 에러의 원인을 간단하게 출력</li><li><code>e.toString()</code> : 에러의 Exception 내용과 원인을 출력</li><li><code>e.printStackTrace()</code> : 에러의 발생 근원지를 찾아서 단계별로 에러를 출력<ul><li>getMesage()와 toString()과는 다르게 printStackTrace는 리턴 값이 없다. 이 메소드를 호출하게 되면 예외 발생 당시의 호출 스택(Call stack)에 있던 메서드의 정보와 예외 결과를 화면에 출력한다.</li></ul></li></ul><p align=center><img src=https://i.imgur.com/9RkBRlu.png width=80%></p><br><a href=#진짜-handling><h3 id=진짜-handling><span class=hanchor arialabel=Anchor># </span>진짜 Handling</h3></a><ol><li><strong>catch</strong>만 하지마라.</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=c1>// Exception 발생 가능 로직
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span> <span class=k>catch</span><span class=o>(???</span><span class=n>Exception</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>예외를 잡기만 하지말고, 로깅 / 복구 등 Exception에 대한 처리를 해라</p><br><ol start=2><li><strong>catch</strong>하고 바로 <strong>throw</strong> 하지마라.</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=c1>// Exception 발생 가능 로직
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span> <span class=k>catch</span><span class=o>(???</span><span class=n>Exception</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=k>throw</span> <span class=n>e</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>예외를 잡자마자 던질 것이면 왜 잡냐? 역시 로깅 / 복구 등 Exception에 대한 처리를 해라</p><br><ol start=3><li><code>e.printStackTrace()</code>는 지양하라</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Exception 발생 가능 로직
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>IOException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>단순하게만 보면, Spring 서버의 콘솔에 얼마나 많은 내용이 찍히겠는가? 그 사이에서 <code>e.printStackTrace()</code> 내용을 찾기는 하늘에 별따기 일 것이다. 또, 따로 로깅을 통해서 파일에 정리해놔야 할 정도로 중요한 내용인데 단순히 출력만 했다고 에러 처리를 끝마쳤다고 볼 수는 없다.</p><p>추가로, <code>printStackTrace()</code>를 지양해야하는 이유는 아래와 같다.</p><ul><li>printStackTrace()를 call 할 경우, System.err로 쓰여져서 제어하기가 힘듦</li><li>printStackTrace()는 java 리플렉션을 사용하여 추적하는 것이라서 많은 오버헤드가 발생할 수 있음</li><li>printStackTrace()는 서버에서 스택정보를 취합하기 때문에 서버에 부하가 발생할 수 있음</li><li>printStackTrace()는 출력이 어디로 가는지 파악하기가 어려움. 톰캣의 경우 <code>catalina.out</code>에 남음</li><li>printStackTrace()는 관리가 힘듦</li></ul><p>로깅 라이브러리는 <strong>log4j</strong>, <strong>logback</strong>, <strong>slf4j</strong>, <strong>commons logging</strong> 등이 있다. 로그 패턴 및 로그 메세지를 지정 및 콘솔로그 / 파일로그 형태로 관리할 수 있다. 이런식으로 printStackTrace가 아닌 로깅을 하도록 하자. 여담으로 2021년에 log4j에서 엄청난 보안 취약점이 발견되어 세상이 뒤집어진 사건이 있었다. 대표적인 취약점 역직렬화, SQL 인젝션, 역직렬화 코드실행이 있는데 자세한건 검색해보길 바란다.</p><details><summary><strong><mark>코드 예시보기</mark></strong></summary><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>private</span> <span class=kd>final</span> <span class=n>Logger</span> <span class=n>logger</span> <span class=o>=</span> <span class=n>LoggerFactory</span><span class=o>.</span><span class=na>getLogger</span><span class=o>(</span><span class=k>this</span><span class=o>.</span><span class=na>getClass</span><span class=o>());</span>  
</span></span><span class=line><span class=cl>  <span class=o>{</span>  
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=o>{</span>  
</span></span><span class=line><span class=cl>        <span class=c1>//블라블라....  
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>FileNotFoundException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=na>error</span><span class=o>(</span><span class=s>&#34;FileNotFoundException&#34;</span><span class=o>,</span> <span class=n>e</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>IOException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=na>error</span><span class=o>(</span><span class=s>&#34;IOException&#34;</span><span class=o>,</span> <span class=n>e</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>    <span class=o>}}</span>
</span></span></code></pre></td></tr></table></div></div></details><br><blockquote class=note-callout><p>Reflection 이란?</p><p>리플렉션은 간단하게 말하면 <strong>구체적인 클래스 타입을 알지 못해도 그 클래스의 메소드, 타입, 변수들에 접근할 수 있도록 해주는 자바 API</strong>이다.<br><br>힙 영역에 로드된 Class 타입의 객체를 통해, 원하는 클래스의 인스턴스를 생성할 수 있도록 지원하고, 인스턴스의 필드와 메소드를 접근 제어자와 상관 없이 사용할 수 있도록 지원하는 API이다.<br><br>여기서 로드된 클래스라고 함은, JVM의 클래스 로더에서 클래스 파일에 대한 로딩을 완료한 후, 해당 클래스의 정보를 담은 <strong>Class 타입의 객체</strong>를 생성하여 메모리의 힙 영역에 저장해 둔 것을 의미한다. new 키워드를 통해 만드는 객체와는 다른 것임을 유의하자.</p></blockquote><br><a href=#printstacktrace-취약점><h3 id=printstacktrace-취약점><span class=hanchor arialabel=Anchor># </span>printStackTrace 취약점</h3></a><p>CWE (Common Weakness Enumeration) 취약점이라는 다양한 소프트웨어 언어 및 아키텍처, 디자인 패턴, 설계 단계에 발생 가능한 취약점이라는 것이 있다. printStackTrace는 <strong>CWE-497</strong>에 등록된 취약점으로 매우 주의하여야 한다.</p><p><strong>CWE-497 : Exposure of Sensitive System Information tp an authorized Control Sphere</strong></p><p>Exception이 발생할 경우 콘솔에 발생지 근원부터 파일 경로 및 각종 정보들이 찍히는데, 이는 내가 아닌 외부인에게도 제공될 수 있다는 것이 큰 취약점이다. 이는 <strong>자바 레벨의 순수 메서드까지 호출 경로가 노출이 된다</strong>는 의미이다.</p><p>따라서, printStackTrace를 사용한 경우에는 디버깅 중에 넣었던 시스템 정보 출력 코드를 반드시 <strong>모두 삭제</strong>하여야 한다.</p><br><a href=#try-with-resources><h3 id=try-with-resources><span class=hanchor arialabel=Anchor># </span>try-with-resources</h3></a><p>자세한 내용은 <a href=https://mangkyu.tistory.com/217 target=_blank>링크</a>를 참고하자. 설명이 너무 잘되어있다.</p><ul><li><p><code>try-catch-finally</code>문에서 resources를 사용 후 반납하는 과정에서 여러 문제점이 있다.</p><ul><li>자원 반납에 의해 코드가 복잡해짐<ul><li>Null 검사 귀찮게 해야해서</li></ul></li><li>실수로 자원을 반납 못함</li><li>에러로 반납 못함</li><li>에러 스택 트레이스가 누락되어 디버깅 어려움</li></ul></li><li><p><code>try-with-resources</code>를 이용하여 문제점을 해결하자.</p><ul><li>코드를 간결하게 만들 수 있음</li><li>번거로운 자원 반납 안해도 됨</li><li>실수로 자원 반납 못하는 경우 방지</li><li>에러로 자원 반납 못하는 경우 방지</li><li>모든 에러에 대한 스택 트레이스 남길 수 있음</li></ul></li></ul><p>그냥 <code>try ( 여기에서 resources 생성 )</code>하면 바로 try-with-resources를 사용하는 것이다. 이는 Java에서 <mark>AutoCloseable 인터페이스를 구현</mark>하고 있는 자원에 대하여 지원한다. 재미있는 점은, AutoCloseable 인터페이스는 Java 7 이전에 있던 기존의 Closeable 인터페이스에 <strong>부모 인터페이스로 추가된 것</strong>이라서 하위 호환성을 100% 달성했다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>Closeable</span> <span class=kd>extends</span> <span class=n>AutoCloseable</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>close</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>IOException</span><span class=o>;</span>  
</span></span><span class=line><span class=cl><span class=o>}</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>AutoCloseable</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>close</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>Exception</span><span class=o>;</span>  
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><br><details><summary><strong><mark>코드 예시보기</mark></strong></summary><ul><li><code>try-catch-finally</code></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span> <span class=n>args</span><span class=o>[])</span> <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>    <span class=n>FileInputStream</span> <span class=n>is</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>  
</span></span><span class=line><span class=cl>    <span class=n>BufferedInputStream</span> <span class=n>bis</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>  
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>        <span class=n>is</span> <span class=o>=</span> <span class=k>new</span> <span class=n>FileInputStream</span><span class=o>(</span><span class=s>&#34;file.txt&#34;</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>        <span class=n>bis</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BufferedInputStream</span><span class=o>(</span><span class=n>is</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>data</span> <span class=o>=</span> <span class=o>-</span><span class=n>1</span><span class=o>;</span>  
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=o>((</span><span class=n>data</span> <span class=o>=</span> <span class=n>bis</span><span class=o>.</span><span class=na>read</span><span class=o>())</span> <span class=o>!=</span> <span class=o>-</span><span class=n>1</span><span class=o>){</span>  
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>((</span><span class=kt>char</span><span class=o>)</span> <span class=n>data</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>        <span class=o>}</span>    
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=k>finally</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>        <span class=c1>// close resources  
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=o>(</span><span class=n>is</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span> <span class=n>is</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>  
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>bis</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span> <span class=n>bis</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>  
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><code>try-with-resources</code></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span> <span class=n>args</span><span class=o>[])</span> <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=o>(</span><span class=n>FileInputStream</span> <span class=n>is</span> <span class=o>=</span> <span class=k>new</span> <span class=n>FileInputStream</span><span class=o>(</span><span class=s>&#34;file.txt&#34;</span><span class=o>);</span> <span class=n>BufferedInputStream</span> <span class=n>bis</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BufferedInputStream</span><span class=o>(</span><span class=n>is</span><span class=o>))</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>data</span><span class=o>;</span>  
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>((</span><span class=n>data</span> <span class=o>=</span> <span class=n>bis</span><span class=o>.</span><span class=na>read</span><span class=o>())</span> <span class=o>!=</span> <span class=o>-</span><span class=n>1</span><span class=o>)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>((</span><span class=kt>char</span><span class=o>)</span> <span class=n>data</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>        <span class=o>}</span>    
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div></details><p><br><br></p><a href=#try-catch-성능><h3 id=try-catch-성능><span class=hanchor arialabel=Anchor># </span>try-catch 성능</h3></a><p>try-catch문을 많이 사용한다면 성능이 어떻게 될 지 의문점을 가졌었다.</p><ul><li><a href=https://stackoverflow.com/questions/16451777/is-it-expensive-to-use-try-catch-blocks-even-if-an-exception-is-never-throw target=_blank>스택오버플로 게시글</a>에서도 <code>try-catch는 성능에 별 영향을 끼치지 않는다 vs JVM이 일부 최적화를 수행하지 못하도록 하기 때문에 영향이 있을 수 있다</code>로 의견이 좀 갈리는 듯 하였다.</li><li><a href=https://january-diary.tistory.com/entry/JAVA-%EC%98%88%EC%99%B8%EC%B2%98%EB%A6%AC%EC%9D%98-%EB%B9%84%EC%9A%A9 target=_blank>다른 게시글</a>에서는 예외를 만들어내는 비용이 크기 때문에 무분별한 남용을 지양하자고 하였다.</li><li>try문 자체는 성능에 영향을 끼치지 않고 exception thread stack을 채우는데 걸리는 시간을 영향에 끼친다고 하는건가? e.printStackTrace 할 때 그것</li></ul><blockquote class=note-callout><p>결론부터 말하겠다</p><p>try-catch 성능저하에 대한 의문점에 답은 예외처리를 했을때와 안했을때 실행시간 차이가 있기는 하지만, 예외처리가 필수로 해야하는 부분은 어쩔수 없고 그렇다고해서 예외처리를 안 할 수 없어서 어느정도는 감안하고 사용한다.<br><br>그리고, <strong>생각보다 실행시간 차이가 크지 않아서, 성능 이슈는 사실 상관없다. 불필요한 예외처리는 비용이 발생하므로, 적절하게 사용하되 방어코드를 사용하는 것이 비용이 덜 소모된다.</strong><br><br><a href=https://jojoldu.tistory.com/58 target=_blank>향로님의 성능 비교 링크</a></p></blockquote><br><p>여기서부터는 고민의 과정일 뿐, 참고만 하자</p><p><strong>Q. try-catch 성능에 관하여</strong></p><ul><li>Java에서 try-catch 블록을 사용하면 특히 코드의 중요한 섹션에서 try-catch 블록을 사용하는 경우 성능에 영향을 줄 수 있다고 한다.</li><li>try-catch 블록이 발생하면 Java는 예외가 발생했는지 여부와 예외를 잡아서 처리해야 하는지 여부를 결정하기 위해 추가 검사를 수행해야 하는데, 이 추가 오버헤드로 인해 코드 실행 속도가 느려질 수 있다.</li><li><strong>그러나 try-catch 블록이 초당 수백만 번 실행되지 않는 한 일반적으로 try-catch 블록의 성능 영향은 최소로 간주된다. 대부분의 경우 예외를 처리하기 위해 try-catch 블록을 사용하는 이점이 약간의 성능 저하보다 크다.</strong></li><li>또한 try-catch 블록의 기본 목적은 예외 상황을 처리하고 예기치 않은 오류가 발생해도 프로그램이 계속 실행되도록 하는 것임을 기억하는 것이 중요하다. 따라서 일반적으로 try-catch 블록을 피함으로써 발생할 수 있는 작은 성능 향상보다 코드 명확성과 정확성을 우선시하는 것이 좋다.</li><li>요약하면 try-catch 블록을 많이 사용하면 성능에 약간의 영향을 줄 수 있지만 일반적으로 최소한의 것으로 간주되며 대부분의 응용 프로그램에서 중요한 문제가 아니다.</li></ul><br><p><strong>Q. Java에서 try-catch 문의 성능 부하를 줄이는 방법에 관하여</strong></p><p>Java에서 try-catch 블록의 성능 영향은 일반적으로 최소로 간주되지만 성능 오버헤드를 추가로 줄이는 데 사용할 수 있는 몇 가지 전략이 있다.</p><ol><li>필요한 경우에만 try-catch 블록 사용 : 예외가 발생할 가능성이 있는 경우에만 try-catch 블록을 사용하는 것이 좋다. 예외가 발생할 가능성이 없는 상황과 같이 불필요하게 사용하지 마라.</li><li>try-catch 블록의 범위 제한 : try-catch 블록의 범위를 가능한 가장 작은 코드 블록으로 제한하라. 이렇게 하면 try-catch 블록 내에서 실행해야 하는 코드의 양을 줄이는 데 도움이 되어 성능 오버헤드를 줄일 수 있습니다.</li><li>조건문 사용: 경우에 따라 try-catch 블록이 필요하지 않도록 조건문을 사용할 수 있다. 예를 들어 예외를 발생시키는 조건을 확인하고 try-catch 블록 내에서 잠재적으로 예외를 발생시킬 수 있는 코드만 실행할 수 있다.</li><li>올바른 예외 처리 메커니즘 사용: Java에는 Checked Exception, Unchecked Exception 및 error와 같은 몇 가지 예외 처리 메커니즘이 있는데, 상황에 맞는 메커니즘을 사용하면 try-catch 블록의 성능 오버헤드를 줄이는 데 도움이 될 수 있다.</li><li>로깅 프레임워크 사용: 예외를 발생시키는 대신 로깅 프레임워크를 사용하여 오류를 기록하고 실행을 계속할 수 있다. 이것은 프로그램이 예외를 처리하기 위해 호출 스택을 중지하고 해제할 필요가 없기 때문에 try-catch 블록의 성능 오버헤드를 줄이는 데 도움이 될 수 있다.</li></ol><p>전반적으로 try-catch 블록의 성능 오버헤드를 줄일 수 있지만 이를 사용하는 주요 목표는 프로그램이 예외 상황을 처리하고 계속 실행되도록 하는 것임을 기억하는 것이 중요하다. 따라서 정확하고 신뢰할 수 있는 소프트웨어의 필요성과 성능 고려 사항의 균형을 맞추는 것이 중요하다.</p><br><hr><a href=#topic-02---spring에서는><h2 id=topic-02---spring에서는><span class=hanchor arialabel=Anchor># </span>TOPIC 02 - Spring에서는?</h2></a><p>몇몇 자바 파일에서 예외 처리하는 것을 넘어, 서버 규모로 넘어가면 어떻게 될까?</p><ul><li>예외처리 해야하는 부분이 매우 많아진다. => <code>try-catch</code>문 남용<ul><li>가독성 저하 : 일반 코드를 예외 처리 코드로 만들면, 코드 본래 목적 혼란스러움</li><li>부작용 발생 : 예외가 발생해도 무시될 수 있어서 개발자가 모르는 부작용 발생, 디버깅 어려워짐</li></ul></li></ul><p>그렇다면, Spring에서는 어떻게 try-catch문을 줄이면서 Exception Handling을 할 수 있을까?</p><p><br><br></p><a href=#스프링-예외처리><h3 id=스프링-예외처리><span class=hanchor arialabel=Anchor># </span>스프링 예외처리</h3></a><p>스프링의 처리과정을 보면 예외처리가 발생하는 부분은 크게 2가지로 나눌 수 있다.</p><ol><li>Dispatcher Servlet 내에서 발생하는 예외 (Controller, Service, Repository 등)</li><li>Dispatcher Servlet 전의 Filter에서 발생하는 예외</li></ol><p>Dispatcher Servlet은 <mark>클라이언트에게 요청을 받아 MVC 처리과정을 통제하는</mark> 것이다. Dispatcher Servlet 내에서라는 의미는 Spring 영역에서의 예외처리를 뜻하는 것이고, Disaptcher Servlet 전은 Spring 영역의 바깥에서 예외처리를 뜻하는 것이다.</p><p><br><br></p><a href=#dispatcher-servlet-내에서><h3 id=dispatcher-servlet-내에서><span class=hanchor arialabel=Anchor># </span>Dispatcher Servlet 내에서</h3></a><p>Dispatcher Servlet 내의 Spring에서 예외처리는 <mark>HandlerExceptionResolver</mark>가 담당한다.</p><p align=center><img src=https://i.imgur.com/TtU0zno.png width=80%></p><ol><li>메서드 단위에서 Handling</li><li>Controller Level에서 Handling</li><li>Global Level에서 Handling</li></ol><br><p><mark><strong>메서드 단위 : try-catch</strong></mark></p><p>메서드 단위는 기존 하던 방법에서 <code>try-catch</code>를 이용하여 Exception Handling하는 과정이다. 그러나, 프로그램의 규모가 커지고 try-catch가 많아져서 가독성 저하, 부작용 발생 등의 단점이 생겨난다면 어떻게 해야할까 ?</p><p><br><br></p><p><mark><strong>Controller Level에서 Handling : @ExceptionHandler</strong></mark></p><p>메서드 하나하나의 예외처리가 아닌, 컨트롤러 레벨에서 예외 처리를 진행한다. 즉, 컨트롤러에서 발생하는 예외를 공통적으로 처리해주는 기능을 이용한 것이다. 이때 <code>@ExceptionHandler</code> 애노테이션을 사용하여 <strong>Controller의 메서드에서 throw된 Exception에 대한 공통적인 처리</strong>를 할 수 있다.</p><ul><li>Controller 메서드 내의 하위 서비스에서 Checked Exception이 발생하더라도, Controller 메서드 상위까지 예외를 throw 시키면 <code>@ExceptionHandler</code> 어노테이션을 사용하여 Controller 전역적으로 예외처리가 가능하다.</li><li>Controller 메서드 내의 하위 서비스에서 Unchecked Exception이 발생하면, 서비스를 호출한 최상위 Controller에서 해당 예외를 처리해준다</li></ul><p>여기에서 나아가, 여러 Controller에서 같은 Exception이 발생하는 경우에, 전체적으로 처리하려면 어떻게 해야할까?</p><p><br><br></p><p><mark><strong>Global Level에서 Handling : @ControllerAdvice</strong></mark></p><p>여러 Controller에서 발생하는 예외를 전역적으로 처리할 수 있다.</p><ul><li>@ControllerAdvice<ul><li>모든 Controller에서 발생하는 예외를 처리하는 애노테이션</li><li>DispatcherServlet에서 발생하는 예외를 전역적으로 처리</li><li>Exception 처리 이후 Error Page 등을 통해 처리가 가능</li></ul></li><li>@RestControllerAdvice<ul><li>REST API에 대한 Exception 처리 용이</li><li>@ControllerAdvice + @ResponseBody</li></ul></li></ul><br><blockquote class=note-callout><p>어떤 @ExceptionHandler가 먼저 실행?</p><p>Controller 클래스 내의 @ExceptionHandler<br>@ControllerAdvice 클래스 내의 @ExceptionHandler<br>둘 중 어떤 것이 먼저 실행될까?<br><br>=>  <strong>Controller 내의 @ExceptionHandler로 예외처리를 하게 되면 거기서 예외처리가 끝난다.</strong> 더 상위로 Exception을 throw하더라도 <strong>@ControllerAdvice의 @ExceptionHandler에서 예외처리를 하지 않는다.</strong></p></blockquote><br><a href=#handlerexceptionresolver><h3 id=handlerexceptionresolver><span class=hanchor arialabel=Anchor># </span>HandlerExceptionResolver</h3></a><p>Dispatcher Servlet 내에서 예외가 발생했을 때 HandlerExceptionResolver이 처리한다고 했다. 이를 자세히 들여다겠다.</p><ul><li>HandlerExceptionResolver는 Controller의 작업 중 발생한 예외를 어떻게 처리할 지에 대한 전략이다.</li><li>Controller에서 Exception이 발생하면 Controller 밖으로 던져짐</li><li>예외가 발생하면 ExceptionResolver가 발동</li><li>Dispatcher Servlet 내부에 등록된 3가지가 순서대로 실행<ol><li>ExceptionHandlerExceptionResolver</li><li>ResponseStatusExceptionResolver</li><li>DefaultHandlerExceptionResolver</li></ol></li></ul><br><p><mark><strong>ExceptionHandlerExceptionResolver</strong></mark></p><p>Spring 3.2의 AnnotationMethodExceptionResolver가 deprecated 처리되었고 Spring 4.0부터 사용하고 있는 ExceptionHandlerExceptionResolver이다. <code>@ExceptionHandler</code> 애노테이션에 관한 Resolver 클래스이다.</p><ol><li>예외가 발생한 Controller 안에 적합한 @ExceptionHandler가 있는지 검사</li><li>Controller의 @ExceptionHandler에서 처리가 가능하다면 처리하고, 그렇지 않으면 @ControllerAdvice로 넘어감</li><li>@ControllerAdvice에 적합한 @ExceptionHandler가 있는지 검사하고 없으면 다음 Resolver로 넘어감</li></ol><br><p><mark><strong>ResponseStatusExceptionResolver</strong></mark></p><p>Exception에 대한 HTTP 응답을 설정해줄 수 있다. 단순히 internal-server-error인 500 에러 대신 더 구체적인 응답 상태값을 전달해줄 수 있다.</p><ol><li>@ResponseStatus가 있는지 혹은 ResponseStatusException인지 검사</li><li>있다면 ServletResponse의 sendError()로 예외를 Servlet까지 전달하고 Servlet이 BasicErrorController로 요청을 전달</li></ol><br><blockquote class=note-callout><p>ResponseStatusException?</p><p>외부 라이브러리를 사용하는 경우, @ResponseStatus 애노테이션으로 직접적으로 수정할 수 없는 상황이 있다. 이때, 상태값에 관하여 직접 핸들링하고 싶은 경우에는 ResponseStatusException을 사용하여 처리한다.</p></blockquote><br><p><mark><strong>DefaultHandlerExceptionResolver</strong></mark></p><p>위의 두 Resolver로도 처리가 안된다면 DefaultHandlerExceptionResolver를 사용하여 내부적으로 Spring 표준 예외처리를 해준다. 각 상황에 맞는 응답 코드를 반환하는 역할이다.</p><ul><li>Request URL에 맞는 Controller를 찾지 못한 경우 - <strong>404 Not Found</strong></li><li>Controller 메서드 실행 중 예외가 발생하는 경우 - <strong>500 Internal Server Error</strong></li><li>Controller의 파라미터 형식이 잘못된 경우 - <strong>400 Bad Request</strong></li></ul><ol><li>Spring의 내부 예외인지 검사하여 맞으면 Exception을 처리하고 아니면 넘어감</li><li>적합한 ExceptionResolver가 없으므로 예외가 Servlet까지 전달되고, Servlet은 SpringBoot가 진행한 자동 설정에 맞게 BasicErrorController로 요청을 다시 전달</li></ol><p><br><br></p><a href=#dispatcher-servlet-외부에서><h3 id=dispatcher-servlet-외부에서><span class=hanchor arialabel=Anchor># </span>Dispatcher Servlet 외부에서</h3></a><p>스프링 영역이 아닌 외부에서 발생하는 Exception은 어떻게 처리해야할까? 이를 말하기에 앞서서 스프링 영역의 컨트롤러 단에서 예외가 발생한 경우, 전체적인 흐름을 먼저 살펴보자.</p><p align=center><img src=https://i.imgur.com/wfzH5da.png width=80%></p><p>Spring MVC request life cycle을 보면, 아래와 같이 흐름이 생긴다.</p><ul><li><mark>WAS -> 필터 -> 서블릿 -> 인터셉터 -> 컨트롤러(예외발생)</mark></li><li><mark>WAS &lt;- 필터 &lt;- 서블릿 &lt;- 인터셉터 &lt;- 컨트롤러</mark></li></ul><p>그렇다면, Dispatcher Servlet 내부인 Spring 영역에서는 HandlerExceptionResolver를 이용하여 다양한 예외 처리를 하는데, <strong>외부인 Filter 단에서 예외가 발생하면 어떻게 처리해야할까?</strong></p><br><p align=center><img src=https://i.imgur.com/U0EBqbk.png width=80%></p><p>이 그림을 봤을 때, Filter 단에서 예외가 발생하면 애초에 <mark>스프링 영역으로 들어가지 못하고, 튕겨져 나온다.</mark> 하지만, <code>@HandlerException</code>, <code>@ControllerAdvice</code>와 같은 예외 처리는 Spring에서 제공하는 애노테이션이라서 스프링 영역이 아닌 필터에서는 사용할 수 없다.</p><br><p align=center><img src=https://i.imgur.com/3JXXEhS.png width=80%></p><p>이러한 경우에는 <mark>Filter에서 try-catch 문으로 예외를 잡아서 처리한다.</mark> 위 그림의 예시로는 <code>doFilter()</code> 메서드를 try-catch로 잡아서 그 시점에 발생한 예외를 곧바로 handling 하는 것이다.</p><br><a href=#filter에서-처리하는-예외><h3 id=filter에서-처리하는-예외><span class=hanchor arialabel=Anchor># </span>Filter에서 처리하는 예외</h3></a><ol><li><strong>(가장중요) 모든 요청에 대한 로깅</strong></li><li>보안 관련 공통 작업 (JWT)</li><li>ServletRequest 커스터마이징</li><li>이미지/데이터 압축 및 문자열 인코딩</li></ol><p>이중, 모든 요청에 대한 로깅은 특히 중요한데, 말 그대로 request, response 등 모든 처리에 관하여 로깅할 수 있다.</p><br><a href=#참고자료><h3 id=참고자료><span class=hanchor arialabel=Anchor># </span>참고자료</h3></a><ul><li><a href=https://cheese10yun.github.io/spring-guide-exception/#null target=_blank>(가장 쓸만할 듯)프로젝트에 적용하면 좋을 실제 Spring 예외</a></li><li><a href=https://www.nextree.co.kr/p3239/ target=_blank>자바에서의 Exception Handling 3가지 방법</a></li><li><a href=https://catsbi.oopy.io/92cfa202-b357-4d47-8de2-b9b3968dfb2e target=_blank>종합적인 예외처리 설명</a></li><li><a href=https://jaehun2841.github.io/2018/08/30/2018-08-25-spring-mvc-handle-exception/#ResponseStatusExceptionResolver target=_blank>Spring Handler Exception</a></li><li><a href=https://github.com/binghe819/TIL/blob/master/Spring/%EA%B8%B0%ED%83%80/%EC%8A%A4%ED%94%84%EB%A7%81%20%EC%98%88%EC%99%B8%EC%B2%98%EB%A6%AC%20%EA%B0%9C%EB%85%90%20%EB%B0%8F%20%EC%A0%84%EB%9E%B5.md target=_blank>스프링 예외처리 개념 전략</a></li><li><a href=https://velog.io/@backtony/면접-시리즈2-Spring-JPA target=_blank>Spring-JPA 면접시리즈</a></li><li><a href=https://terasolunaorg.github.io/guideline/5.3.0.RELEASE/en/ArchitectureInDetail/WebApplicationDetail/ExceptionHandling.html#exception-handling-basic-flow-label target=_blank>(원본)Exception Handling Guideline</a></li><li><a href=https://steady-coding.tistory.com/601 target=_blank>Filter vs Interceptor</a></li><li><a href=https://velog.io/@wonizizi99/SpringSpring%EC%9D%98-%EC%98%88%EC%99%B8-%EC%B2%98%EB%A6%AC-%ED%9D%90%EB%A6%84 target=_blank>Spring에서의 예외 처리 흐름도</a></li><li><a href=https://jhkimmm.tistory.com/29 target=_blank>Filter 내에서 발생한 예외 처리하기</a></li><li><a href=https://beemiel.tistory.com/11 target=_blank>Spring Security JWT 토큰 검증시 Exception 처리</a></li></ul></div></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>백링크</h3><ul class=backlinks><li><a href=/notes/Interview/dog-study/dog-study/ data-ctx data-src=/notes/Interview/dog-study/dog-study class=internal-link>개발바닥 면접스터디</a></li><li><a href=/notes/Interview/dog-study/dog-week01/ data-ctx="2주차 스터디 참고" data-src=/notes/Interview/dog-study/dog-week01 class=internal-link>불변객체, Exception</a></li></ul></div><div><script async src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>연결된 그래프</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://shin-jae-yoon.github.io/js/graph.6e7ebeb092c6c6becbfe976056a9303b.js></script></div></div><div id=contact_buttons><footer><p style=margin-bottom:0>Made by Dev Uni using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2023</p><p style=margin-top:0><a href=https://github.com/Shin-Jae-Yoon/Shin-Jae-Yoon.github.io>Dev Uni</a> has customized it by adding a few features.</p><ul><li><a href=https://github.com/Shin-Jae-Yoon><i class="fab fa-github"></i></a></li><li><a href=https://jae-yoon.tistory.com/><i class="fa-solid fa-tenge-sign"></i></a></li><li><a href=mailto:wlwhsvkdlxh@gmail.com><i class="fa-solid fa-envelope"></i></a></li></ul></footer></div><div class=top-btn><i class="top-btn-img fa-solid fa-circle-arrow-up"></i></div><div class=bottom-btn><i class="bottom-btn-img fa-solid fa-circle-arrow-down"></i></div></div><script>document.querySelector(".top-btn").addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}),document.querySelector(".bottom-btn").addEventListener("click",()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})})</script></body></html>